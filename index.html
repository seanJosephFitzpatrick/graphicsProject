<!DOCTYPE html>

<html>

<head>
    <meta charset="UTF-8">
    <title>Canvas</title>


    <style type="text/css">
        body {
            background-color: white;
        }
        
        canvas {
            border: 1px solid black;
        }
    </style>

</head>

<body>

    <!--//canvas id, height and width -->
    <canvas id="canvas-for-ball" height="600px" width="1000px"></canvas>

    <script type="text/javascript">
        // Gets a handle to the element with id canvasOne.
        var canvas = document.getElementById("canvas-for-ball");
        // Get a 2D context for the canvas.
        var ctx = canvas.getContext("2d");

        // An object for the ball.
        var ball = {
            position: {
                x: 200,
                y: 10
            },
            radius: 10,
            velocity: {
                x: 2,
                y: 5
            },
            drawBall: function() {
                // Draw the balL.
                ctx.arc(ball.position.x, ball.position.y, ball.radius, 0, 2 * Math.PI);
                ctx.fillStyle = "red";
                ctx.fill();
            }
        }

        //An object for the paddle
        var paddle = {
            position: {
                x: 590,
                y: 400
            },
            size: {
                w: 100,
                h: 10
            },
            drawPaddle: function() {
                //Draw the paddle
                ctx.fillStyle = "blue";
                ctx.fill();
                ctx.fillRect(paddle.position.y, paddle.position.x, paddle.size.w, paddle.size.h);
            }
        }
        
        //Use math.random, round it down with math.florr and store in varialbe m and n and use for x and y coordinates.
        var n = Math.floor((Math.random() * 570) + 1); 
        var m = Math.floor((Math.random() * 900) + 1); 

        var block = {
            position: {
                x: n, //Use random n value for x coordinate
                y: m //use random m variable for y coordinate
            },
            size: {
                w: 100,
                h: 20
            },
            drawBlock: function() {
                ctx.fillStyle = "green";
                ctx.fill();
                ctx.fillRect(block.position.y, block.position.x, block.size.w, block.size.h);

            }
        }
        
        
        //Draw paddle function
        function movePaddle() {

            if (event.keyCode == 39) {
                //If the paddles y position is less than 900 then increment the y position
                if (paddle.position.y < 900)
                    paddle.position.y += 10;
            } else if (event.keyCode == 37) {
                //If the paddles y position is greater than zero then decrement the y position
                if (paddle.position.y > 0)
                    paddle.position.y -= 10;
            }
        }
        
        //Ian's init function
        function init() {
            
            ctx.beginPath();
            ball.drawBall();
            ctx.closePath();

            ctx.beginPath();
            paddle.drawPaddle();
            ctx.closePath();
            
          

            ctx.beginPath();
            block.drawBlock();
            ctx.closePath();
           
            if (ball.position.y - ball.radius > canvas.height)
                endGame();
        }

        function endGame() {
            exit();
        }
        
        // A function to repeat every time the animation loops.
        function repeatme() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Update the y location.
            ball.position.x += ball.velocity.x;
            ball.position.y += ball.velocity.y;

            //If the ball's x position is not greater than the canvas width
            if ((ball.position.x >= canvas.width - ball.radius) || (ball.position.x <= ball.radius))
                ball.velocity.x = -ball.velocity.x;
            /*If the ball's y position is not greater than the paddles x position and 
            if the balls x position is in between the paddles y start and end postion*/
            if ((ball.position.y >= paddle.position.x - ball.radius) && ((ball.position.x > paddle.position.y &&
                    (ball.position.x < paddle.position.y + 100))) || (ball.position.y <= ball.radius))
                ball.velocity.y = -ball.velocity.y;

            init();


            window.addEventListener('keydown', movePaddle, true);

            window.requestAnimationFrame(repeatme);

        }

        // Get the animation going.
        window.requestAnimationFrame(repeatme);
    </script>

</body>

</html>